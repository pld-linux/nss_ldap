diff -ur nss_ldap.orig/configure.in nss_ldap/configure.in
--- nss_ldap.orig/configure.in	2004-05-14 03:34:11.000000000 +0000
+++ nss_ldap/configure.in	2004-06-08 09:30:01.000000000 +0000
@@ -146,7 +146,7 @@
 AC_CHECK_HEADERS(gssapi/gssapi_krb5.h)
 
 AC_CHECK_LIB(resolv, main)
-AC_CHECK_LIB(nsl, main)
+AC_SEARCH_LIBS(gethostbyname, nsl)
 
 AC_CHECK_FUNCS(strtok_r)
 AC_CHECK_FUNCS(sigaction)
@@ -189,8 +189,10 @@
   with_ldap_lib=auto
 fi
 
-AC_CHECK_LIB(dl, dlopen,[LIBS="-ldl $LIBS"],,$LIBS)
-AC_CHECK_LIB(db, main,[LIBS="-ldb $LIBS"],,$LIBS)
+dnl AC_CHECK_LIB(dl, dlopen,[LIBS="-ldl $LIBS"],,$LIBS)
+if test "$enable_rfc2307bis" = "yes" -o "$enable_schema_mapping" = "yes" ; then
+	AC_CHECK_LIB(db, main,[LIBS="-ldb $LIBS"],,$LIBS)
+fi
 
 AC_CHECK_LIB(gssapi, gss_krb5_ccache_name,[LIBS="-lgssapi $LIBS" found_gssapi_lib=yes],,$LIBS)
 if test -z "$found_gssapi_lib"; then
